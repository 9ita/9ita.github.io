### 카오스 엔지니어링(Chaos Engineering)

**카오스 엔지니어링(Chaos Engineering)**은 **복잡한 분산 시스템**에서 예기치 않은 장애나 문제를 미리 예상하고 준비하기 위한 방법론입니다. 카오스 엔지니어링은 시스템이 실제로 장애를 겪었을 때 어떤 영향을 받는지 실험을 통해 확인하고, 시스템의 **탄력성(Resilience)**과 **안정성(Reliability)**을 향상시키는 것을 목표로 합니다.

#### 카오스 엔지니어링의 주요 원칙

1. **실제 장애 시나리오를 시뮬레이션**: 시스템 내에서 예상치 못한 장애가 발생했을 때, 시스템이 어떤 영향을 받는지 실험한다. 이러한 장애는 서버의 종료, 네트워크 지연, 높은 트래픽 등 여러 시나리오로 시뮬레이션된다.
   
2. **작은 스케일에서 시작**: 처음부터 전체 시스템에 장애를 주기보다는, 작은 스케일에서 시작하여 점진적으로 실험을 확장한다.

3. **모든 실험은 프로덕션 환경에서 수행**: 실험은 실제 프로덕션 환경에서 실행되어야만 그 결과가 신뢰할 수 있다. 단, 실험이 사용자에게 직접적인 영향을 미치지 않도록 신중하게 설계된다.

4. **시스템의 상태를 관찰 및 기록**: 실험 중에는 시스템 상태(로그, 메트릭 등)를 지속적으로 모니터링하여, 장애 발생 시의 동작을 분석할 수 있어야 한다.

5. **결과 분석과 피드백 루프**: 실험 결과는 시스템의 문제를 파악하고, 이를 개선하는 피드백 루프를 통해 시스템의 안정성과 복원력을 높이는 데 활용된다.

---

### 장애 가설 예상(Fault Hypothesis)

카오스 엔지니어링에서 중요한 것은 **장애 가설**을 세우는 것입니다. 이는 시스템이 예상치 못한 상황에 처했을 때 어떤 결과가 발생할지 예측하는 것입니다. 장애 가설을 세우고, 실험을 통해 이를 검증하여 시스템의 문제점을 찾아내고 해결하는 과정을 반복합니다.

#### 장애 가설 예상의 주요 단계

1. **기능 이해**: 시스템의 주요 기능과 워크로드를 이해하여, 시스템이 어떻게 동작하는지 파악한다.
   
2. **위험 분석**: 시스템에서 가장 큰 장애 위험이 무엇인지 분석한다. 이를 위해 **단일 장애점(Single Point of Failure)**, 네트워크 불안정성, 트래픽 폭증, 하드웨어 오류 등을 고려한다.

3. **가설 수립**: 장애가 발생했을 때 시스템이 어떤 동작을 할 것인지 가설을 세운다.
   - 예시: "한 노드가 다운되면, 서비스가 자동으로 다른 노드로 트래픽을 라우팅할 것이다."

4. **가설 검증**: 실제로 장애를 주입하여 가설이 맞는지 검증한다. 만약 가설이 틀렸다면, 시스템에 문제점이 있다는 뜻이며 이를 개선할 수 있는 기회가 된다.

#### 장애 가설 예시
- "DB 서버 중 하나가 다운되면, 시스템은 여전히 트래픽을 처리할 수 있을 것이다."
- "네트워크가 지연되면, 요청 시간은 늘어나지만 시스템은 트랜잭션을 성공적으로 완료할 것이다."
- "서비스 A가 서비스 B로의 요청을 실패하면, 시스템은 이를 자동으로 다시 시도할 것이다."

---

### 스트레스 테스트(Stress Testing)

**스트레스 테스트**는 시스템의 한계치를 확인하고, 시스템이 특정 부하 상황에서 어떻게 동작하는지 평가하기 위해 실행되는 테스트입니다. 스트레스 테스트는 시스템이 예상 이상의 부하를 처리할 수 있는지, 장애 발생 시 어떻게 대응하는지 확인할 수 있는 중요한 테스트 방법론입니다.

#### 스트레스 테스트의 목표

1. **시스템의 한계 파악**: 시스템이 어느 정도의 부하까지 처리할 수 있는지 확인한다. 이를 통해 병목 현상과 시스템의 성능 저하 지점을 찾을 수 있다.
   
2. **오류 처리 능력 평가**: 시스템이 과부하 상태에서 정상적으로 오류를 처리할 수 있는지 평가한다.

3. **시스템 복원력 테스트**: 스트레스 상황에서 시스템이 어떻게 복구되는지를 확인하고, 복구 후 시스템 상태를 분석한다.

4. **안정성 확보**: 부하를 걸면서도 시스템이 어떻게 안정적으로 동작하는지 확인하여, 실제 운영 환경에서 발생할 수 있는 장애에 대비한다.

#### 스트레스 테스트 유형

1. **Spike Test**: 매우 짧은 시간 동안 갑작스러운 트래픽 폭증을 시뮬레이션한다. 이는 예상치 못한 트래픽 급증에 시스템이 어떻게 대응하는지를 평가하는 데 유용하다.

2. **Soak Test (장시간 부하 테스트)**: 장기간 동안 일정한 수준 이상의 트래픽을 시스템에 가해 시스템이 오랜 시간 동안 안정적으로 동작하는지 평가한다.

3. **Break Test**: 시스템에 계속해서 부하를 증가시키면서 **시스템이 언제 어떻게 실패하는지**를 확인한다. 이 테스트는 시스템의 **최대 용량**을 확인하는 데 중점을 둔다.

#### 스트레스 테스트 도구

- **Apache JMeter**: 오픈소스 부하 테스트 도구로, 다양한 시나리오에서 웹 애플리케이션, API 등에 부하를 가할 수 있다.
- **Gatling**: 고성능 부하 테스트 도구로, 실시간으로 성능 데이터를 제공하며 시뮬레이션을 쉽게 작성할 수 있다.
- **Locust**: Python 기반의 부하 테스트 도구로, 사용자 정의 시나리오를 작성하여 시스템에 부하를 가할 수 있다.
- **k6**: JavaScript로 테스트 스크립트를 작성해 부하 테스트를 수행할 수 있으며, 클라우드와 통합이 용이하다.

#### 스트레스 테스트 시나리오 예시

1. **트래픽 폭증**: 평소보다 10배 이상의 트래픽을 짧은 시간에 시스템에 주입하여 서비스가 어떻게 반응하는지 확인.
   
2. **디스크 I/O 스트레스**: 대량의 데이터를 읽고 쓰는 작업을 병렬로 실행하여 디스크의 한계를 파악하고, 디스크가 가득 찬 상황에서 서비스가 어떻게 동작하는지 평가.

3. **메모리 한계 테스트**: 점진적으로 메모리를 점유하는 시나리오를 만들어 메모리 부족 상황에서 시스템의 성능과 안정성을 평가.

4. **네트워크 대역폭 테스트**: 네트워크 대역폭을 소진시키고, 서비스가 네트워크 지연이나 대역폭 제한 하에서 어떻게 동작하는지 확인.

---
